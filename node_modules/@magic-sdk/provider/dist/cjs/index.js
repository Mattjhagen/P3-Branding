"use strict";var Ft=Object.create;var te=Object.defineProperty,Jt=Object.defineProperties,Gt=Object.getOwnPropertyDescriptor,Kt=Object.getOwnPropertyDescriptors,jt=Object.getOwnPropertyNames,it=Object.getOwnPropertySymbols,Bt=Object.getPrototypeOf,ct=Object.prototype.hasOwnProperty,Ht=Object.prototype.propertyIsEnumerable;var at=(n,t,e)=>t in n?te(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e,B=(n,t)=>{for(var e in t||(t={}))ct.call(t,e)&&at(n,e,t[e]);if(it)for(var e of it(t))Ht.call(t,e)&&at(n,e,t[e]);return n},he=(n,t)=>Jt(n,Kt(t));var Vt=(n,t)=>()=>(t||n((t={exports:{}}).exports,t),t.exports),lt=(n,t)=>{for(var e in t)te(n,e,{get:t[e],enumerable:!0})},ut=(n,t,e,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of jt(t))!ct.call(n,s)&&s!==e&&te(n,s,{get:()=>t[s],enumerable:!(r=Gt(t,s))||r.enumerable});return n};var Xt=(n,t,e)=>(e=n!=null?Ft(Bt(n)):{},ut(t||!n||!n.__esModule?te(e,"default",{value:n,enumerable:!0}):e,n)),zt=n=>ut(te({},"__esModule",{value:!0}),n);var m=(n,t,e)=>new Promise((r,s)=>{var o=c=>{try{i(e.next(c))}catch(u){s(u)}},a=c=>{try{i(e.throw(c))}catch(u){s(u)}},i=c=>c.done?r(c.value):Promise.resolve(c.value).then(o,a);i((e=e.apply(n,t)).next())});var Nt=Vt((Cr,Ve)=>{"use strict";var jn=Object.prototype.hasOwnProperty,M="~";function ie(){}Object.create&&(ie.prototype=Object.create(null),new ie().__proto__||(M=!1));function Bn(n,t,e){this.fn=n,this.context=t,this.once=e||!1}function xt(n,t,e,r,s){if(typeof e!="function")throw new TypeError("The listener must be a function");var o=new Bn(e,r||n,s),a=M?M+t:t;return n._events[a]?n._events[a].fn?n._events[a]=[n._events[a],o]:n._events[a].push(o):(n._events[a]=o,n._eventsCount++),n}function ve(n,t){--n._eventsCount===0?n._events=new ie:delete n._events[t]}function w(){this._events=new ie,this._eventsCount=0}w.prototype.eventNames=function(){var t=[],e,r;if(this._eventsCount===0)return t;for(r in e=this._events)jn.call(e,r)&&t.push(M?r.slice(1):r);return Object.getOwnPropertySymbols?t.concat(Object.getOwnPropertySymbols(e)):t};w.prototype.listeners=function(t){var e=M?M+t:t,r=this._events[e];if(!r)return[];if(r.fn)return[r.fn];for(var s=0,o=r.length,a=new Array(o);s<o;s++)a[s]=r[s].fn;return a};w.prototype.listenerCount=function(t){var e=M?M+t:t,r=this._events[e];return r?r.fn?1:r.length:0};w.prototype.emit=function(t,e,r,s,o,a){var i=M?M+t:t;if(!this._events[i])return!1;var c=this._events[i],u=arguments.length,l,p;if(c.fn){switch(c.once&&this.removeListener(t,c.fn,void 0,!0),u){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,e),!0;case 3:return c.fn.call(c.context,e,r),!0;case 4:return c.fn.call(c.context,e,r,s),!0;case 5:return c.fn.call(c.context,e,r,s,o),!0;case 6:return c.fn.call(c.context,e,r,s,o,a),!0}for(p=1,l=new Array(u-1);p<u;p++)l[p-1]=arguments[p];c.fn.apply(c.context,l)}else{var $=c.length,I;for(p=0;p<$;p++)switch(c[p].once&&this.removeListener(t,c[p].fn,void 0,!0),u){case 1:c[p].fn.call(c[p].context);break;case 2:c[p].fn.call(c[p].context,e);break;case 3:c[p].fn.call(c[p].context,e,r);break;case 4:c[p].fn.call(c[p].context,e,r,s);break;default:if(!l)for(I=1,l=new Array(u-1);I<u;I++)l[I-1]=arguments[I];c[p].fn.apply(c[p].context,l)}}return!0};w.prototype.on=function(t,e,r){return xt(this,t,e,r,!1)};w.prototype.once=function(t,e,r){return xt(this,t,e,r,!0)};w.prototype.removeListener=function(t,e,r,s){var o=M?M+t:t;if(!this._events[o])return this;if(!e)return ve(this,o),this;var a=this._events[o];if(a.fn)a.fn===e&&(!s||a.once)&&(!r||a.context===r)&&ve(this,o);else{for(var i=0,c=[],u=a.length;i<u;i++)(a[i].fn!==e||s&&!a[i].once||r&&a[i].context!==r)&&c.push(a[i]);c.length?this._events[o]=c.length===1?c[0]:c:ve(this,o)}return this};w.prototype.removeAllListeners=function(t){var e;return t?(e=M?M+t:t,this._events[e]&&ve(this,e)):(this._events=new ie,this._eventsCount=0),this};w.prototype.off=w.prototype.removeListener;w.prototype.addListener=w.prototype.on;w.prefixed=M;w.EventEmitter=w;typeof Ve<"u"&&(Ve.exports=w)});var fr={};lt(fr,{Extension:()=>k,MagicExtensionError:()=>K,MagicExtensionWarning:()=>X,MagicRPCError:()=>L,MagicSDKError:()=>S,MagicSDKWarning:()=>G,SDKBase:()=>ue,STORE_KEY_PRIVATE_KEY:()=>Pe,STORE_KEY_PUBLIC_JWK:()=>ce,TypedEmitter:()=>Te,ViewController:()=>Oe,clearKeys:()=>Qn,createDeprecationWarning:()=>O,createDuplicateIframeWarning:()=>Fn,createExtensionNotInitializedError:()=>Ge,createIncompatibleExtensionsError:()=>Ke,createInvalidArgumentError:()=>je,createJwt:()=>Qe,createMalformedResponseError:()=>Je,createMissingApiKeyError:()=>We,createModalNotReadyError:()=>Fe,createPromiEvent:()=>_,createPromise:()=>Ie,createReactNativeEndpointConfigurationWarning:()=>He,createSDK:()=>bt,createSynchronousWeb3MethodWarning:()=>Be,createTypedEmitter:()=>ae,createURL:()=>Me,decodeJSON:()=>qe,encodeJSON:()=>oe,getPayloadId:()=>Re,isEmpty:()=>V,isJsonRpcErrorCode:()=>Ue,isJsonRpcRequestPayload:()=>Un,isJsonRpcResponsePayload:()=>De,isMagicPayloadMethod:()=>Wn,isMajorVersionAtLeast:()=>ze,isPromiEvent:()=>Xe,isWebCryptoSupported:()=>Z,storage:()=>Y,uuid:()=>Ze});module.exports=zt(fr);function Yt(n){let t={exports:{}};return n(t,t.exports),t.exports}var Zt=Number.MAX_SAFE_INTEGER||9007199254740991;var ke={SEMVER_SPEC_VERSION:"2.0.0",MAX_LENGTH:256,MAX_SAFE_INTEGER:Zt,MAX_SAFE_COMPONENT_LENGTH:16},Qt=typeof process=="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...n)=>console.error("SEMVER",...n):()=>{},f=Qt,se=Yt(function(n,t){let{MAX_SAFE_COMPONENT_LENGTH:e}=ke,r=(t=n.exports={}).re=[],s=t.src=[],o=t.t={},a=0,i=(c,u,l)=>{let p=a++;f(p,u),o[c]=p,s[p]=u,r[p]=new RegExp(u,l?"g":void 0)};i("NUMERICIDENTIFIER","0|[1-9]\\d*"),i("NUMERICIDENTIFIERLOOSE","[0-9]+"),i("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-][a-zA-Z0-9-]*"),i("MAINVERSION",`(${s[o.NUMERICIDENTIFIER]})\\.(${s[o.NUMERICIDENTIFIER]})\\.(${s[o.NUMERICIDENTIFIER]})`),i("MAINVERSIONLOOSE",`(${s[o.NUMERICIDENTIFIERLOOSE]})\\.(${s[o.NUMERICIDENTIFIERLOOSE]})\\.(${s[o.NUMERICIDENTIFIERLOOSE]})`),i("PRERELEASEIDENTIFIER",`(?:${s[o.NUMERICIDENTIFIER]}|${s[o.NONNUMERICIDENTIFIER]})`),i("PRERELEASEIDENTIFIERLOOSE",`(?:${s[o.NUMERICIDENTIFIERLOOSE]}|${s[o.NONNUMERICIDENTIFIER]})`),i("PRERELEASE",`(?:-(${s[o.PRERELEASEIDENTIFIER]}(?:\\.${s[o.PRERELEASEIDENTIFIER]})*))`),i("PRERELEASELOOSE",`(?:-?(${s[o.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${s[o.PRERELEASEIDENTIFIERLOOSE]})*))`),i("BUILDIDENTIFIER","[0-9A-Za-z-]+"),i("BUILD",`(?:\\+(${s[o.BUILDIDENTIFIER]}(?:\\.${s[o.BUILDIDENTIFIER]})*))`),i("FULLPLAIN",`v?${s[o.MAINVERSION]}${s[o.PRERELEASE]}?${s[o.BUILD]}?`),i("FULL",`^${s[o.FULLPLAIN]}$`),i("LOOSEPLAIN",`[v=\\s]*${s[o.MAINVERSIONLOOSE]}${s[o.PRERELEASELOOSE]}?${s[o.BUILD]}?`),i("LOOSE",`^${s[o.LOOSEPLAIN]}$`),i("GTLT","((?:<|>)?=?)"),i("XRANGEIDENTIFIERLOOSE",`${s[o.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),i("XRANGEIDENTIFIER",`${s[o.NUMERICIDENTIFIER]}|x|X|\\*`),i("XRANGEPLAIN",`[v=\\s]*(${s[o.XRANGEIDENTIFIER]})(?:\\.(${s[o.XRANGEIDENTIFIER]})(?:\\.(${s[o.XRANGEIDENTIFIER]})(?:${s[o.PRERELEASE]})?${s[o.BUILD]}?)?)?`),i("XRANGEPLAINLOOSE",`[v=\\s]*(${s[o.XRANGEIDENTIFIERLOOSE]})(?:\\.(${s[o.XRANGEIDENTIFIERLOOSE]})(?:\\.(${s[o.XRANGEIDENTIFIERLOOSE]})(?:${s[o.PRERELEASELOOSE]})?${s[o.BUILD]}?)?)?`),i("XRANGE",`^${s[o.GTLT]}\\s*${s[o.XRANGEPLAIN]}$`),i("XRANGELOOSE",`^${s[o.GTLT]}\\s*${s[o.XRANGEPLAINLOOSE]}$`),i("COERCE",`(^|[^\\d])(\\d{1,${e}})(?:\\.(\\d{1,${e}}))?(?:\\.(\\d{1,${e}}))?(?:$|[^\\d])`),i("COERCERTL",s[o.COERCE],!0),i("LONETILDE","(?:~>?)"),i("TILDETRIM",`(\\s*)${s[o.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",i("TILDE",`^${s[o.LONETILDE]}${s[o.XRANGEPLAIN]}$`),i("TILDELOOSE",`^${s[o.LONETILDE]}${s[o.XRANGEPLAINLOOSE]}$`),i("LONECARET","(?:\\^)"),i("CARETTRIM",`(\\s*)${s[o.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",i("CARET",`^${s[o.LONECARET]}${s[o.XRANGEPLAIN]}$`),i("CARETLOOSE",`^${s[o.LONECARET]}${s[o.XRANGEPLAINLOOSE]}$`),i("COMPARATORLOOSE",`^${s[o.GTLT]}\\s*(${s[o.LOOSEPLAIN]})$|^$`),i("COMPARATOR",`^${s[o.GTLT]}\\s*(${s[o.FULLPLAIN]})$|^$`),i("COMPARATORTRIM",`(\\s*)${s[o.GTLT]}\\s*(${s[o.LOOSEPLAIN]}|${s[o.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",i("HYPHENRANGE",`^\\s*(${s[o.XRANGEPLAIN]})\\s+-\\s+(${s[o.XRANGEPLAIN]})\\s*$`),i("HYPHENRANGELOOSE",`^\\s*(${s[o.XRANGEPLAINLOOSE]})\\s+-\\s+(${s[o.XRANGEPLAINLOOSE]})\\s*$`),i("STAR","(<|>)?=?\\s*\\*"),i("GTE0","^\\s*>=\\s*0.0.0\\s*$"),i("GTE0PRE","^\\s*>=\\s*0.0.0-0\\s*$")}),dt=/^[0-9]+$/,vt=(n,t)=>{let e=dt.test(n),r=dt.test(t);return e&&r&&(n=+n,t=+t),n===t?0:e&&!r?-1:r&&!e?1:n<t?-1:1},en=(n,t)=>vt(t,n),tn={compareIdentifiers:vt,rcompareIdentifiers:en},{MAX_LENGTH:pt,MAX_SAFE_INTEGER:me}=ke,{re:ht,t:mt}=se,{compareIdentifiers:ne}=tn,g=class{constructor(t,e){if(e&&typeof e=="object"||(e={loose:!!e,includePrerelease:!1}),t instanceof g){if(t.loose===!!e.loose&&t.includePrerelease===!!e.includePrerelease)return t;t=t.version}else if(typeof t!="string")throw new TypeError(`Invalid Version: ${t}`);if(t.length>pt)throw new TypeError(`version is longer than ${pt} characters`);f("SemVer",t,e),this.options=e,this.loose=!!e.loose,this.includePrerelease=!!e.includePrerelease;let r=t.trim().match(e.loose?ht[mt.LOOSE]:ht[mt.FULL]);if(!r)throw new TypeError(`Invalid Version: ${t}`);if(this.raw=t,this.major=+r[1],this.minor=+r[2],this.patch=+r[3],this.major>me||this.major<0)throw new TypeError("Invalid major version");if(this.minor>me||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>me||this.patch<0)throw new TypeError("Invalid patch version");r[4]?this.prerelease=r[4].split(".").map(s=>{if(/^[0-9]+$/.test(s)){let o=+s;if(o>=0&&o<me)return o}return s}):this.prerelease=[],this.build=r[5]?r[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(t){if(f("SemVer.compare",this.version,this.options,t),!(t instanceof g)){if(typeof t=="string"&&t===this.version)return 0;t=new g(t,this.options)}return t.version===this.version?0:this.compareMain(t)||this.comparePre(t)}compareMain(t){return t instanceof g||(t=new g(t,this.options)),ne(this.major,t.major)||ne(this.minor,t.minor)||ne(this.patch,t.patch)}comparePre(t){if(t instanceof g||(t=new g(t,this.options)),this.prerelease.length&&!t.prerelease.length)return-1;if(!this.prerelease.length&&t.prerelease.length)return 1;if(!this.prerelease.length&&!t.prerelease.length)return 0;let e=0;do{let r=this.prerelease[e],s=t.prerelease[e];if(f("prerelease compare",e,r,s),r===void 0&&s===void 0)return 0;if(s===void 0)return 1;if(r===void 0)return-1;if(r!==s)return ne(r,s)}while(++e)}compareBuild(t){t instanceof g||(t=new g(t,this.options));let e=0;do{let r=this.build[e],s=t.build[e];if(f("prerelease compare",e,r,s),r===void 0&&s===void 0)return 0;if(s===void 0)return 1;if(r===void 0)return-1;if(r!==s)return ne(r,s)}while(++e)}inc(t,e){switch(t){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",e);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",e);break;case"prepatch":this.prerelease.length=0,this.inc("patch",e),this.inc("pre",e);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",e),this.inc("pre",e);break;case"major":this.minor===0&&this.patch===0&&this.prerelease.length!==0||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":this.patch===0&&this.prerelease.length!==0||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":if(this.prerelease.length===0)this.prerelease=[0];else{let r=this.prerelease.length;for(;--r>=0;)typeof this.prerelease[r]=="number"&&(this.prerelease[r]++,r=-2);r===-1&&this.prerelease.push(0)}e&&(this.prerelease[0]===e?isNaN(this.prerelease[1])&&(this.prerelease=[e,0]):this.prerelease=[e,0]);break;default:throw new Error(`invalid increment argument: ${t}`)}return this.format(),this.raw=this.version,this}},nn=(n,t,e)=>new g(n,e).compare(new g(t,e)),H=nn,rn=(n,t,e)=>H(n,t,e)===0,sn=rn,on=(n,t,e)=>H(n,t,e)!==0,an=on,cn=(n,t,e)=>H(n,t,e)>0,ln=cn,un=(n,t,e)=>H(n,t,e)>=0,dn=un,pn=(n,t,e)=>H(n,t,e)<0,hn=pn,mn=(n,t,e)=>H(n,t,e)<=0,fn=mn,En=(n,t,e,r)=>{switch(t){case"===":return typeof n=="object"&&(n=n.version),typeof e=="object"&&(e=e.version),n===e;case"!==":return typeof n=="object"&&(n=n.version),typeof e=="object"&&(e=e.version),n!==e;case"":case"=":case"==":return sn(n,e,r);case"!=":return an(n,e,r);case">":return ln(n,e,r);case">=":return dn(n,e,r);case"<":return hn(n,e,r);case"<=":return fn(n,e,r);default:throw new TypeError(`Invalid operator: ${t}`)}},_e=En,re=Symbol("SemVer ANY"),U=class{static get ANY(){return re}constructor(t,e){if(e&&typeof e=="object"||(e={loose:!!e,includePrerelease:!1}),t instanceof U){if(t.loose===!!e.loose)return t;t=t.value}f("comparator",t,e),this.options=e,this.loose=!!e.loose,this.parse(t),this.semver===re?this.value="":this.value=this.operator+this.semver.version,f("comp",this)}parse(t){let e=this.options.loose?ft[Et.COMPARATORLOOSE]:ft[Et.COMPARATOR],r=t.match(e);if(!r)throw new TypeError(`Invalid comparator: ${t}`);this.operator=r[1]!==void 0?r[1]:"",this.operator==="="&&(this.operator=""),r[2]?this.semver=new g(r[2],this.options.loose):this.semver=re}toString(){return this.value}test(t){if(f("Comparator.test",t,this.options.loose),this.semver===re||t===re)return!0;if(typeof t=="string")try{t=new g(t,this.options)}catch(e){return!1}return _e(t,this.operator,this.semver,this.options)}intersects(t,e){if(!(t instanceof U))throw new TypeError("a Comparator is required");if(e&&typeof e=="object"||(e={loose:!!e,includePrerelease:!1}),this.operator==="")return this.value===""||new q(t.value,e).test(this.value);if(t.operator==="")return t.value===""||new q(this.value,e).test(t.semver);let r=!(this.operator!==">="&&this.operator!==">"||t.operator!==">="&&t.operator!==">"),s=!(this.operator!=="<="&&this.operator!=="<"||t.operator!=="<="&&t.operator!=="<"),o=this.semver.version===t.semver.version,a=!(this.operator!==">="&&this.operator!=="<="||t.operator!==">="&&t.operator!=="<="),i=_e(this.semver,"<",t.semver,e)&&(this.operator===">="||this.operator===">")&&(t.operator==="<="||t.operator==="<"),c=_e(this.semver,">",t.semver,e)&&(this.operator==="<="||this.operator==="<")&&(t.operator===">="||t.operator===">");return r||s||o&&a||i||c}},{re:ft,t:Et}=se,q=class{constructor(t,e){if(e&&typeof e=="object"||(e={loose:!!e,includePrerelease:!1}),t instanceof q)return t.loose===!!e.loose&&t.includePrerelease===!!e.includePrerelease?t:new q(t.raw,e);if(t instanceof U)return this.raw=t.value,this.set=[[t]],this.format(),this;if(this.options=e,this.loose=!!e.loose,this.includePrerelease=!!e.includePrerelease,this.raw=t,this.set=t.split(/\s*\|\|\s*/).map(r=>this.parseRange(r.trim())).filter(r=>r.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${t}`);this.format()}format(){return this.range=this.set.map(t=>t.join(" ").trim()).join("||").trim(),this.range}toString(){return this.range}parseRange(t){let{loose:e}=this.options;t=t.trim();let r=e?b[T.HYPHENRANGELOOSE]:b[T.HYPHENRANGE];t=t.replace(r,$n(this.options.includePrerelease)),f("hyphen replace",t),t=t.replace(b[T.COMPARATORTRIM],gn),f("comparator trim",t,b[T.COMPARATORTRIM]),t=(t=(t=t.replace(b[T.TILDETRIM],yn)).replace(b[T.CARETTRIM],Rn)).split(/\s+/).join(" ");let s=e?b[T.COMPARATORLOOSE]:b[T.COMPARATOR];return t.split(" ").map(o=>vn(o,this.options)).join(" ").split(/\s+/).map(o=>Nn(o,this.options)).filter(this.options.loose?o=>!!o.match(s):()=>!0).map(o=>new U(o,this.options))}intersects(t,e){if(!(t instanceof q))throw new TypeError("a Range is required");return this.set.some(r=>gt(r,e)&&t.set.some(s=>gt(s,e)&&r.every(o=>s.every(a=>o.intersects(a,e)))))}test(t){if(!t)return!1;if(typeof t=="string")try{t=new g(t,this.options)}catch(e){return!1}for(let e=0;e<this.set.length;e++)if(An(this.set[e],t,this.options))return!0;return!1}},{re:b,t:T,comparatorTrimReplace:gn,tildeTrimReplace:yn,caretTrimReplace:Rn}=se,gt=(n,t)=>{let e=!0,r=n.slice(),s=r.pop();for(;e&&r.length;)e=r.every(o=>s.intersects(o,t)),s=r.pop();return e},vn=(n,t)=>(f("comp",n,t),n=bn(n,t),f("caret",n),n=Tn(n,t),f("tildes",n),n=Pn(n,t),f("xrange",n),n=xn(n,t),f("stars",n),n),P=n=>!n||n.toLowerCase()==="x"||n==="*",Tn=(n,t)=>n.trim().split(/\s+/).map(e=>In(e,t)).join(" "),In=(n,t)=>{let e=t.loose?b[T.TILDELOOSE]:b[T.TILDE];return n.replace(e,(r,s,o,a,i)=>{let c;return f("tilde",n,r,s,o,a,i),P(s)?c="":P(o)?c=`>=${s}.0.0 <${+s+1}.0.0-0`:P(a)?c=`>=${s}.${o}.0 <${s}.${+o+1}.0-0`:i?(f("replaceTilde pr",i),c=`>=${s}.${o}.${a}-${i} <${s}.${+o+1}.0-0`):c=`>=${s}.${o}.${a} <${s}.${+o+1}.0-0`,f("tilde return",c),c})},bn=(n,t)=>n.trim().split(/\s+/).map(e=>wn(e,t)).join(" "),wn=(n,t)=>{f("caret",n,t);let e=t.loose?b[T.CARETLOOSE]:b[T.CARET],r=t.includePrerelease?"-0":"";return n.replace(e,(s,o,a,i,c)=>{let u;return f("caret",n,s,o,a,i,c),P(o)?u="":P(a)?u=`>=${o}.0.0${r} <${+o+1}.0.0-0`:P(i)?u=o==="0"?`>=${o}.${a}.0${r} <${o}.${+a+1}.0-0`:`>=${o}.${a}.0${r} <${+o+1}.0.0-0`:c?(f("replaceCaret pr",c),u=o==="0"?a==="0"?`>=${o}.${a}.${i}-${c} <${o}.${a}.${+i+1}-0`:`>=${o}.${a}.${i}-${c} <${o}.${+a+1}.0-0`:`>=${o}.${a}.${i}-${c} <${+o+1}.0.0-0`):(f("no pr"),u=o==="0"?a==="0"?`>=${o}.${a}.${i}${r} <${o}.${a}.${+i+1}-0`:`>=${o}.${a}.${i}${r} <${o}.${+a+1}.0-0`:`>=${o}.${a}.${i} <${+o+1}.0.0-0`),f("caret return",u),u})},Pn=(n,t)=>(f("replaceXRanges",n,t),n.split(/\s+/).map(e=>Mn(e,t)).join(" ")),Mn=(n,t)=>{n=n.trim();let e=t.loose?b[T.XRANGELOOSE]:b[T.XRANGE];return n.replace(e,(r,s,o,a,i,c)=>{f("xRange",n,r,s,o,a,i,c);let u=P(o),l=u||P(a),p=l||P(i),$=p;return s==="="&&$&&(s=""),c=t.includePrerelease?"-0":"",u?r=s===">"||s==="<"?"<0.0.0-0":"*":s&&$?(l&&(a=0),i=0,s===">"?(s=">=",l?(o=+o+1,a=0,i=0):(a=+a+1,i=0)):s==="<="&&(s="<",l?o=+o+1:a=+a+1),s==="<"&&(c="-0"),r=`${s+o}.${a}.${i}${c}`):l?r=`>=${o}.0.0${c} <${+o+1}.0.0-0`:p&&(r=`>=${o}.${a}.0${c} <${o}.${+a+1}.0-0`),f("xRange return",r),r})},xn=(n,t)=>(f("replaceStars",n,t),n.trim().replace(b[T.STAR],"")),Nn=(n,t)=>(f("replaceGTE0",n,t),n.trim().replace(b[t.includePrerelease?T.GTE0PRE:T.GTE0],"")),$n=n=>(t,e,r,s,o,a,i,c,u,l,p,$,I)=>`${e=P(r)?"":P(s)?`>=${r}.0.0${n?"-0":""}`:P(o)?`>=${r}.${s}.0${n?"-0":""}`:a?`>=${e}`:`>=${e}${n?"-0":""}`} ${c=P(u)?"":P(l)?`<${+u+1}.0.0-0`:P(p)?`<${u}.${+l+1}.0-0`:$?`<=${u}.${l}.${p}-${$}`:n?`<${u}.${l}.${+p+1}-0`:`<=${c}`}`.trim(),An=(n,t,e)=>{for(let r=0;r<n.length;r++)if(!n[r].test(t))return!1;if(t.prerelease.length&&!e.includePrerelease){for(let r=0;r<n.length;r++)if(f(n[r].semver),n[r].semver!==U.ANY&&n[r].semver.prerelease.length>0){let s=n[r].semver;if(s.major===t.major&&s.minor===t.minor&&s.patch===t.patch)return!0}return!1}return!0},Tt=(n,t,e)=>{try{t=new q(t,e)}catch(r){return!1}return t.test(n)};var{MAX_LENGTH:Cn}=ke,{re:yt,t:Rt}=se,Sn=(n,t)=>{if(t&&typeof t=="object"||(t={loose:!!t,includePrerelease:!1}),n instanceof g)return n;if(typeof n!="string"||n.length>Cn||!(t.loose?yt[Rt.LOOSE]:yt[Rt.FULL]).test(n))return null;try{return new g(n,t)}catch(e){return null}},Ln=Sn,{re:fe,t:Ee}=se,It=(n,t)=>{if(n instanceof g)return n;if(typeof n=="number"&&(n=String(n)),typeof n!="string")return null;let e=null;if((t=t||{}).rtl){let r;for(;(r=fe[Ee.COERCERTL].exec(n))&&(!e||e.index+e[0].length!==n.length);)e&&r.index+r[0].length===e.index+e[0].length||(e=r),fe[Ee.COERCERTL].lastIndex=r.index+r[1].length+r[2].length;fe[Ee.COERCERTL].lastIndex=-1}else e=n.match(fe[Ee.COERCE]);return e===null?null:Ln(`${e[2]}.${e[3]||"0"}.${e[4]||"0"}`,t)};function On(n){return String.fromCharCode(parseInt(n.slice(1),16))}function _n(n){return`%${`00${n.charCodeAt(0).toString(16)}`.slice(-2)}`}function kn(n){return btoa(encodeURIComponent(n).replace(/%[0-9A-F]{2}/g,On))}function qn(n){return decodeURIComponent(Array.from(atob(n),_n).join(""))}function oe(n){return kn(JSON.stringify(n))}function qe(n){return JSON.parse(qn(n))}var A=require("@magic-sdk/types");var ge=require("@magic-sdk/types");function D(n){return typeof n=="undefined"}function Dn(n){return n===null}function ye(n){return Dn(n)||D(n)}function Un(n){return ye(n)?!1:!D(n.jsonrpc)&&!D(n.id)&&!D(n.method)&&!D(n.params)}function De(n){return ye(n)?!1:!D(n.jsonrpc)&&!D(n.id)&&(!D(n.result)||!D(n.error))}function Wn(n){return ye(n)?!1:typeof n=="string"&&Object.values(ge.MagicPayloadMethod).includes(n)}function Ue(n){return ye(n)?!1:typeof n=="number"&&Object.values(ge.RPCErrorCode).includes(n)}function V(n){if(!n)return!0;for(let t in n)if(Object.hasOwnProperty.call(n,t))return!1;return!0}var h={};function bt(n,t){return Object.assign(h,t),n}var wt={"magic-sdk":"magic-sdk","@magic-sdk/react-native":"magic-sdk-rn","@magic-sdk/react-native-bare":"magic-sdk-rn-bare","@magic-sdk/react-native-expo":"magic-sdk-rn-expo"};var S=class extends Error{constructor(e,r){super(`Magic SDK Error: [${e}] ${r}`);this.code=e;this.rawMessage=r;this.__proto__=Error;Object.setPrototypeOf(this,S.prototype)}},L=class extends Error{constructor(e){super();this.__proto__=Error;let r=Number(e==null?void 0:e.code);this.rawMessage=(e==null?void 0:e.message)||"Internal error",this.code=Ue(r)?r:A.RPCErrorCode.InternalError,this.message=`Magic RPC Error: [${this.code}] ${this.rawMessage}`,this.data=(e==null?void 0:e.data)||void 0,Object.setPrototypeOf(this,L.prototype)}},G=class{constructor(t,e){this.code=t;this.rawMessage=e;this.message=`Magic SDK Warning: [${t}] ${e}`}log(){console.warn(this.message)}},K=class extends Error{constructor(e,r,s,o){super(`Magic Extension Error (${e.name}): [${r}] ${s}`);this.code=r;this.rawMessage=s;this.data=o;this.__proto__=Error;Object.setPrototypeOf(this,K.prototype)}},X=class{constructor(t,e,r){this.code=e;this.rawMessage=r;this.message=`Magic Extension Warning (${t.name}): [${e}] ${r}`}log(){console.warn(this.message)}};function We(){return new S(A.SDKErrorCode.MissingApiKey,"Please provide an API key that you acquired from the Magic developer dashboard.")}function Fe(){return new S(A.SDKErrorCode.ModalNotReady,"Modal is not ready.")}function Je(){return new S(A.SDKErrorCode.MalformedResponse,"Response from the Magic iframe is malformed.")}function Ge(n){return new S(A.SDKErrorCode.ExtensionNotInitialized,`Extensions must be initialized with a Magic SDK instance before \`Extension.${n}\` can be accessed. Do not invoke \`Extension.${n}\` inside an extension constructor.`)}function Ke(n){let t=`Some extensions are incompatible with \`${h.sdkName}@${h.version}\`:`;return n.filter(e=>typeof e.compat!="undefined"&&e.compat!==null).forEach(e=>{let r=e.compat[h.sdkName];typeof r=="string"?t+=`
  - Extension \`${e.name}\` supports version(s) \`${r}\``:r||(t+=`
  - Extension \`${e.name}\` does not support ${h.platform} environments.`)}),new S(A.SDKErrorCode.IncompatibleExtensions,t)}function je(n){let t=e=>{let r=e+1,s=r%10,o=r%100;return s===1&&o!==11?`${r}st`:s===2&&o!==12?`${r}nd`:s===3&&o!==13?`${r}rd`:`${r}th`};return new S(A.SDKErrorCode.InvalidArgument,`Invalid ${t(n.argument)} argument given to \`${n.procedure}\`.
  Expected: \`${n.expected}\`
  Received: \`${n.received}\``)}function Fn(){return new G(A.SDKWarningCode.DuplicateIframe,"Duplicate iframes found.")}function Be(){return new G(A.SDKWarningCode.SyncWeb3Method,"Non-async web3 methods are deprecated in web3 > 1.0 and are not supported by the Magic web3 provider. Please use an async method instead.")}function He(){return new G(A.SDKWarningCode.ReactNativeEndpointConfiguration,`CUSTOM DOMAINS ARE NOT SUPPORTED WHEN USING MAGIC SDK WITH REACT NATIVE! The \`endpoint\` parameter SHOULD NOT be provided. The Magic \`<iframe>\` is automatically wrapped by a WebView pointed at \`${h.defaultEndpoint}\`. Changing this default behavior will lead to unexpected results and potentially security-threatening bugs.`)}function O(n){let{method:t,removalVersions:e,useInstead:r}=n,s=e[h.sdkName],o=r?` Use \`${r}\` instead.`:"",a=`\`${t}\` will be removed from \`${h.sdkName}\` in version \`${s}\`.${o}`;return new G(A.SDKWarningCode.DeprecationNotice,a)}var y=require("@magic-sdk/types");var z=require("@magic-sdk/types");function*Jn(){let n=0;for(;;)n<Number.MAX_SAFE_INTEGER?yield++n:n=0}var Gn=Jn();function Re(){return Gn.next().value}var Pt=Symbol("Payload pre-processed by Magic SDK");function Mt(n){return Object.defineProperty(n,Pt,{value:!0,enumerable:!1}),n}function Kn(n){return!!n[Pt]}function j(n){var t,e,r;return Kn(n)||(n.jsonrpc=(t=n.jsonrpc)!=null?t:"2.0",n.id=Re(),n.method=(e=n.method)!=null?e:"noop",n.params=(r=n.params)!=null?r:[],Mt(n)),n}function d(n,t=[]){return Mt({params:t,method:n,jsonrpc:"2.0",id:Re()})}var W=class{constructor(t){t instanceof W?(this._jsonrpc=t.payload.jsonrpc,this._id=t.payload.id,this._result=t.payload.result,this._error=t.payload.error):De(t)?(this._jsonrpc=t.jsonrpc,this._id=t.id,this._result=t.result,this._error=t.error):(this._jsonrpc=t.jsonrpc,this._id=t.id,this._result=void 0,this._error=void 0)}applyError(t){return this._error=t,this}applyResult(t){return this._result=t,this}get hasError(){return typeof this._error!="undefined"&&this._error!==null}get hasResult(){return typeof this._result!="undefined"}get payload(){return{jsonrpc:this._jsonrpc,id:this._id,result:this._result,error:this._error}}};var $t=Xt(Nt()),Te=class extends $t.default{};function ae(){let n=new Te;return{emitter:n,createChainingEmitterMethod:(r,s)=>(...o)=>(n[r].apply(n,o),s),createBoundEmitterMethod:r=>(...s)=>n[r].apply(n,s)}}var At=Symbol("isPromiEvent");function Xe(n){return!!n[At]}function _(n){let t=Ie(n),{createBoundEmitterMethod:e,createChainingEmitterMethod:r}=ae(),s=Symbol("Promise.then"),o=Symbol("Promise.catch"),a=Symbol("Promise.finally"),i=(l,p)=>(...$)=>{let I=p[l].apply(p,$);return c(I)},c=l=>Object.assign(l,{[At]:!0,[s]:l[s]||l.then,[o]:l[o]||l.catch,[a]:l[a]||l.finally,then:i(s,l),catch:i(o,l),finally:i(a,l),on:r("on",l),once:r("once",l),addListener:r("addListener",l),off:r("off",l),removeListener:r("removeListener",l),removeAllListeners:r("removeAllListeners",l),emit:e("emit"),eventNames:e("eventNames"),listeners:e("listeners"),listenerCount:e("listenerCount")}),u=c(t.then(l=>(u.emit("done",l),u.emit("settled"),l),l=>{throw u.emit("error",l),u.emit("settled"),l}));return u}function Ie(n){return new Promise((t,e)=>{let r=n(t,e);Promise.resolve(r).catch(e)})}var x=class{constructor(t){this.sdk=t}get overlay(){return this.sdk.overlay}request(t){let e=this.overlay.post(z.MagicOutgoingWindowMessage.MAGIC_HANDLE_REQUEST,j(t)),r=_((o,a)=>{e.then(i=>{if(s(),i.hasError)a(new L(i.payload.error));else if(i.hasResult)o(i.payload.result);else throw Je()}).catch(i=>{s(),a(i)})}),s=this.overlay.on(z.MagicIncomingWindowMessage.MAGIC_HANDLE_EVENT,o=>{var i;let{response:a}=o.data;if(a.id===t.id&&((i=a.result)==null?void 0:i.event)){let{event:c,params:u=[]}=a.result;r.emit(c,...u)}});return r}createIntermediaryEvent(t,e){return s=>{let o=d(z.MagicPayloadMethod.IntermediaryEvent,[{payloadId:e,eventType:t,args:s}]);this.request(o)}}};function ze(n,t){let[e]=n.split(".").map(Number);return e>=t}var F={"magic-sdk":"v18.0.0","@magic-sdk/react-native":"v14.0.0","@magic-sdk/react-native-bare":"v19.0.0","@magic-sdk/react-native-expo":"v19.0.0"},be=class extends x{loginWithMagicLink(t){let e=h.sdkName==="@magic-sdk/react-native"||h.sdkName==="@magic-sdk/react-native-bare"||h.sdkName==="@magic-sdk/react-native-expo";if(e&&ze(h.version,19))throw new Error("loginWithMagicLink() is deprecated for this package, please utlize a passcode method like loginWithSMS or loginWithEmailOTP instead.");e&&O({method:"auth.loginWithMagicLink()",removalVersions:F,useInstead:"auth.loginWithEmailOTP()"}).log();let{email:r,showUI:s=!0,redirectURI:o,overrides:a}=t,i=d(this.sdk.testMode?y.MagicPayloadMethod.LoginWithMagicLinkTestMode:y.MagicPayloadMethod.LoginWithMagicLink,[{email:r,showUI:s,redirectURI:o,overrides:a}]);return this.request(i)}loginWithSMS(t){let{phoneNumber:e}=t,r=d(this.sdk.testMode?y.MagicPayloadMethod.LoginWithSmsTestMode:y.MagicPayloadMethod.LoginWithSms,[{phoneNumber:e,showUI:!0}]);return this.request(r)}loginWithEmailOTP(t){let{email:e,showUI:r,deviceCheckUI:s,overrides:o}=t,a=d(this.sdk.testMode?y.MagicPayloadMethod.LoginWithEmailOTPTestMode:y.MagicPayloadMethod.LoginWithEmailOTP,[{email:e,showUI:r,deviceCheckUI:s,overrides:o}]),i=this.request(a);return!s&&i&&i.on(y.DeviceVerificationEventEmit.Retry,()=>{this.createIntermediaryEvent(y.DeviceVerificationEventEmit.Retry,a.id)()}),!r&&i&&(i.on(y.LoginWithEmailOTPEventEmit.VerifyEmailOtp,c=>{this.createIntermediaryEvent(y.LoginWithEmailOTPEventEmit.VerifyEmailOtp,a.id)(c)}),i.on(y.LoginWithEmailOTPEventEmit.Cancel,()=>{this.createIntermediaryEvent(y.LoginWithEmailOTPEventEmit.Cancel,a.id)()})),i}loginWithCredential(t){let e=t!=null?t:"";if(!t&&h.platform==="web"){e=window.location.search;let s=window.location.origin+window.location.pathname;window.history.replaceState(null,"",s)}let r=d(this.sdk.testMode?y.MagicPayloadMethod.LoginWithCredentialTestMode:y.MagicPayloadMethod.LoginWithCredential,[e]);return this.request(r)}setAuthorizationToken(t){let e=d(y.MagicPayloadMethod.SetAuthorizationToken,[{jwt:t}]);return this.request(e)}updateEmailWithUI(t){let{email:e,showUI:r=!0}=t,s=d(this.sdk.testMode?y.MagicPayloadMethod.UpdateEmailTestMode:y.MagicPayloadMethod.UpdateEmail,[{email:e,showUI:r}]);return this.request(s)}};var v=require("@magic-sdk/types");var Y={};lt(Y,{clear:()=>Hn,getItem:()=>R,iterate:()=>Ye,key:()=>Xn,keys:()=>zn,length:()=>Vn,removeItem:()=>C,setItem:()=>N});var we;function J(n){return(...t)=>m(this,null,function*(){return we||(we=yield h.configureStorage()),yield we.ready(),we[n](...t)})}var R=J("getItem"),N=J("setItem"),C=J("removeItem"),Hn=J("clear"),Vn=J("length"),Xn=J("key"),zn=J("keys"),Ye=J("iterate");function Ze(){let n=window.crypto.getRandomValues(new Uint8Array(16));n[6]=n[6]&15|64,n[8]=n[8]&191|128;let t="";return t+=n[0].toString(16),t+=n[1].toString(16),t+=n[2].toString(16),t+=n[3].toString(16),t+="-",t+=n[4].toString(16),t+=n[5].toString(16),t+="-",t+=n[6].toString(16),t+=n[7].toString(16),t+="-",t+=n[8].toString(16),t+=n[9].toString(16),t+="-",t+=n[10].toString(16),t+=n[11].toString(16),t+=n[12].toString(16),t+=n[13].toString(16),t+=n[14].toString(16),t+=n[15].toString(16),t}var Pe="STORE_KEY_PRIVATE_KEY",ce="STORE_KEY_PUBLIC_JWK",St="ECDSA",Yn="P-256",Zn={name:St,namedCurve:Yn};function Z(){let n=typeof window!="undefined"&&!!window.crypto,t=n&&!!window.crypto.subtle;return n&&t}function Qn(){C(ce),C(Pe)}function Qe(){return m(this,null,function*(){let n=yield er();if(!n){console.info("unable to create public key or webcrypto is unsupported");return}let{subtle:t}=window.crypto,e=yield R(Pe);if(!e||!t){console.info("unable to find private key or webcrypto unsupported");return}let r={iat:Math.floor(new Date().getTime()/1e3),jti:Ze()},s={typ:"dpop+jwt",alg:"ES256",jwk:n},o={protected:Ct(JSON.stringify(s)),claims:Ct(JSON.stringify(r))},a=nr(`${o.protected}.${o.claims}`),i={name:St,hash:{name:"SHA-256"}},c=sr(new Uint8Array(yield t.sign(i,e,a)));return`${o.protected}.${o.claims}.${c}`})}function er(){return m(this,null,function*(){if(!Z()){console.info("webcrypto is not supported");return}return(yield R(ce))||(yield tr()),R(ce)})}function tr(){return m(this,null,function*(){let{subtle:n}=window.crypto,t=yield n.generateKey(Zn,!1,["sign"]),e=yield n.exportKey("jwk",t.publicKey);yield N(Pe,t.privateKey),yield N(ce,e)})}function Ct(n){return Lt(rr(n))}function nr(n){return new TextEncoder().encode(n)}function Lt(n){return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+/g,"")}function rr(n){return encodeURIComponent(n).replace(/%([0-9A-F]{2})/g,(e,r)=>String.fromCharCode(parseInt(r,16)))}function sr(n){let t="";return n.forEach(e=>{t+=String.fromCharCode(e)}),Lt(t)}var et="ds",tt="ek",nt="iv",rt="AES-GCM",or=256;function Q(){return m(this,null,function*(){let n=[];yield Ye((t,e,r)=>{e.startsWith(`${et}_`)&&n.push(e)});for(let t of n)yield C(t)})}function Ot(n){let t="",e=new Uint8Array(n),r=e.byteLength;for(let s=0;s<r;s++)t+=String.fromCharCode(e[s]);return window.btoa(t)}function _t(n){let t=window.atob(n),e=t.length,r=new Uint8Array(e);for(let s=0;s<e;s++)r[s]=t.charCodeAt(s);return r.buffer}function ir(){return m(this,null,function*(){if(!Z()){console.info("webcrypto is not supported");return}let{crypto:n}=window,t=yield R(nt);return t||n.getRandomValues(new Uint8Array(12))})}function ar(){return m(this,null,function*(){if(!Z()){console.info("webcrypto is not supported");return}let{subtle:n}=window.crypto,t=yield R(tt);return t||(yield n.generateKey({name:rt,length:or},!1,["encrypt","decrypt"]))})}function kt(n,t){return m(this,null,function*(){let e=yield ir(),r=yield ar();if(!e||!r||!n)return;let s=_t(n),{subtle:o}=window.crypto,a=yield o.encrypt({name:rt,iv:e},r,s),i=Ot(a);yield N(`${et}_${t}`,i),yield N(tt,r),yield N(nt,e)})}function qt(n){return m(this,null,function*(){let t=yield R(`${et}_${n}`),e=yield R(nt),r=yield R(tt);if(!e||!t||!r||!Z())return;let{subtle:s}=window.crypto,o=yield s.decrypt({name:rt,iv:e},r,_t(t));return Ot(o)})}function Me(n,t){return t?new URL(n,t):new URL(n)}var xe=class extends x{constructor(){super(...arguments);this.localForageKey="mc_active_wallet";this.localForageIsLoggedInKey="magic_auth_is_logged_in";this.userLoggedOutCallbacks=[]}getIdToken(e){let r=d(this.sdk.testMode?v.MagicPayloadMethod.GetIdTokenTestMode:v.MagicPayloadMethod.GetIdToken,[e]);return this.request(r)}generateIdToken(e){let r=d(this.sdk.testMode?v.MagicPayloadMethod.GenerateIdTokenTestMode:v.MagicPayloadMethod.GenerateIdToken,[e]);return this.request(r)}getInfo(){return m(this,null,function*(){let e=yield R(this.localForageKey),r=d(v.MagicPayloadMethod.GetInfo,[{walletType:e}]);return this.request(r)})}isLoggedIn(){return _((e,r)=>m(this,null,function*(){try{let s=!1;this.sdk.useStorageCache&&(s=(yield R(this.localForageIsLoggedInKey))==="true",s&&e(!0));let o=d(this.sdk.testMode?v.MagicPayloadMethod.IsLoggedInTestMode:v.MagicPayloadMethod.IsLoggedIn),a=yield this.request(o);this.sdk.useStorageCache&&(a?N(this.localForageIsLoggedInKey,!0):C(this.localForageIsLoggedInKey),s&&!a&&this.emitUserLoggedOut(!0)),e(a)}catch(s){r(s)}}))}logout(){return C(this.localForageKey),C(this.localForageIsLoggedInKey),Q(),_((e,r)=>m(this,null,function*(){try{let s=d(this.sdk.testMode?v.MagicPayloadMethod.LogoutTestMode:v.MagicPayloadMethod.Logout),o=yield this.request(s);this.sdk.useStorageCache&&this.emitUserLoggedOut(o),e(o)}catch(s){r(s)}}))}requestInfoWithUI(e){let r=d(v.MagicPayloadMethod.RequestUserInfoWithUI,e?[e]:[]);return this.request(r)}showSettings(e){let r=d(this.sdk.testMode?v.MagicPayloadMethod.UserSettingsTestMode:v.MagicPayloadMethod.UserSettings,[e]);return this.request(r)}recoverAccount(e){let r=d(this.sdk.testMode?v.MagicPayloadMethod.RecoverAccountTestMode:v.MagicPayloadMethod.RecoverAccount,[e]);return this.request(r)}getMetadata(){O({method:"user.getMetadata()",removalVersions:F,useInstead:"user.getInfo()"}).log();let e=d(this.sdk.testMode?v.MagicPayloadMethod.GetMetadataTestMode:v.MagicPayloadMethod.GetMetadata);return this.request(e)}updateEmail(e){O({method:"user.updateEmail()",removalVersions:F,useInstead:"auth.updateEmailWithUI()"}).log();let{email:r,showUI:s=!0}=e,o=d(this.sdk.testMode?v.MagicPayloadMethod.UpdateEmailTestMode:v.MagicPayloadMethod.UpdateEmail,[{email:r,showUI:s}]);return this.request(o)}onUserLoggedOut(e){this.userLoggedOutCallbacks.push(e)}emitUserLoggedOut(e){this.userLoggedOutCallbacks.forEach(r=>{r(e)})}};var E=require("@magic-sdk/types");var Ne=class extends x{constructor(){super(...arguments);this.localForageKey="mc_active_wallet"}connectWithUI(){let e=_((r,s)=>m(this,null,function*(){try{if(this.isMetaMaskBrowser()&&(yield this.isWalletEnabled(E.Wallets.MetaMask))){let u=yield this.autoConnectIfWalletBrowser(E.Wallets.MetaMask);r(u);return}if(this.isCoinbaseWalletBrowser()&&(yield this.isWalletEnabled(E.Wallets.CoinbaseWallet))){let u=yield this.autoConnectIfWalletBrowser(E.Wallets.CoinbaseWallet);r(u);return}let o=this.getUserEnv(),a=d(E.MagicPayloadMethod.Login,[o]),i=this.request(a);i.on(E.Events.WalletSelected,u=>this.handleWalletSelected(he(B({},u),{payloadId:a.id}))),i.on("id-token-created",u=>{e.emit("id-token-created",u)});let c=yield i;c.error&&s(c),r(c)}catch(o){s(o)}}));return e}showUI(){return this.request(d(E.MagicPayloadMethod.ShowUI))}showAddress(){return this.request(d(E.MagicPayloadMethod.ShowAddress))}showSendTokensUI(){return this.request(d(E.MagicPayloadMethod.ShowSendTokensUI))}showOnRamp(){return this.request(d(E.MagicPayloadMethod.ShowOnRamp))}showNFTs(){return this.request(d(E.MagicPayloadMethod.ShowNFTs))}showBalances(){return this.request(d(E.MagicPayloadMethod.ShowBalances))}sendGaslessTransaction(e,r){return this.request(d(E.MagicPayloadMethod.SendGaslessTransaction,[e,r]))}getInfo(){return m(this,null,function*(){O({method:"wallet.getInfo()",removalVersions:F,useInstead:"user.getInfo()"}).log();let e=yield R(this.localForageKey),r=d(E.MagicPayloadMethod.GetInfo,[{walletType:e}]);return this.request(r)})}disconnect(){O({method:"wallet.disconnect()",removalVersions:F,useInstead:"user.logout()"}).log(),C(this.localForageKey),Q();let e=d(E.MagicPayloadMethod.Disconnect);return this.request(e)}requestUserInfoWithUI(e){O({method:"wallet.requestUserInfoWithUI()",removalVersions:F,useInstead:"user.requestUserInfoWithUI()"}).log();let r=d(E.MagicPayloadMethod.RequestUserInfoWithUI,e?[e]:[]);return this.request(r)}getProvider(){return m(this,null,function*(){switch(yield R(this.localForageKey)){case E.Wallets.MetaMask:return this.getMetaMaskProvider();case E.Wallets.CoinbaseWallet:return this.getCoinbaseProvider();default:return this.sdk.rpcProvider}})}isMetaMaskInstalled(){var e,r,s;return((e=window.ethereum)==null?void 0:e.isMetaMask)||!!((s=(r=window.ethereum)==null?void 0:r.providers)!=null&&s.find(o=>o==null?void 0:o.isMetaMask))}isMetaMaskBrowser(){return this.isMobile()&&this.isMetaMaskInstalled()}getMetaMaskProvider(){var e,r;return((r=(e=window.ethereum)==null?void 0:e.providers)==null?void 0:r.find(s=>s==null?void 0:s.isMetaMask))||window.ethereum}connectToMetaMask(){if(this.isMobile()&&!this.isMetaMaskInstalled()){let e=`https://metamask.app.link/dapp/${window.location.href.replace(/(^\w+:|^)\/\//,"")}`;window.location.href=e}return this.getMetaMaskProvider().request({method:"eth_requestAccounts"})}isCoinbaseWalletInstalled(){var e,r,s;return((e=window.ethereum)==null?void 0:e.isCoinbaseWallet)||!!((s=(r=window.ethereum)==null?void 0:r.providers)!=null&&s.find(o=>o==null?void 0:o.isCoinbaseWallet))}isCoinbaseWalletBrowser(){var e;return!!((e=window.ethereum)!=null&&e.isCoinbaseBrowser)}getCoinbaseProvider(){var e,r;return((r=(e=window.ethereum)==null?void 0:e.providers)==null?void 0:r.find(s=>s==null?void 0:s.isCoinbaseWallet))||window.ethereum}connectToCoinbaseWallet(){if(this.isMobile()&&!this.isCoinbaseWalletBrowser()){let r=`https://go.cb-w.com/dapp?cb_url=${encodeURIComponent(window.location.href)}`;window.location.href=r}return this.getCoinbaseProvider().request({method:"eth_requestAccounts"})}isMobile(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|BB|PlayBook|IEMobile|Windows Phone|Silk|Opera Mini/i.test(navigator.userAgent)}getUserEnv(){return{env:{isMetaMaskInstalled:this.isMetaMaskInstalled(),isCoinbaseWalletInstalled:this.isCoinbaseWalletInstalled()}}}connectToThirdPartyWallet(e){switch(e){case E.Wallets.MetaMask:return this.connectToMetaMask();case E.Wallets.CoinbaseWallet:return this.connectToCoinbaseWallet();default:throw new Error(`Invalid provider: ${e}. Must be one of "metamask" or "coinbase_wallet".`)}}isWalletEnabled(e){let r=d("mc_is_wallet_enabled",[{wallet:e}]);return this.request(r)}handleWalletSelected(e){return m(this,null,function*(){try{let r=yield this.connectToThirdPartyWallet(e.wallet);yield N(this.localForageKey,e.wallet),this.createIntermediaryEvent(E.Events.WalletConnected,e.payloadId)(r)}catch(r){console.error(r),this.createIntermediaryEvent(E.Events.WalletRejected,e.payloadId)()}})}autoConnectIfWalletBrowser(e){return m(this,null,function*(){let r;e===E.Wallets.MetaMask&&(r=yield this.getMetaMaskProvider().request({method:"eth_requestAccounts"})),e===E.Wallets.CoinbaseWallet&&(r=yield this.getCoinbaseProvider().request({method:"eth_requestAccounts"})),yield N(this.localForageKey,e);let s=d(E.MagicPayloadMethod.AutoConnect,[{wallet:e,address:r}]);return this.request(s)})}};var le=require("@magic-sdk/types");var{createBoundEmitterMethod:$e,createChainingEmitterMethod:ee}=ae(),Ae=class extends x{constructor(){super(...arguments);this.isMagic=!0;this.on=ee("on",this);this.once=ee("once",this);this.addListener=ee("addListener",this);this.off=ee("off",this);this.removeListener=ee("removeListener",this);this.removeAllListeners=ee("removeAllListeners",this);this.emit=$e("emit");this.eventNames=$e("eventNames");this.listeners=$e("listeners");this.listenerCount=$e("listenerCount")}sendAsync(e,r){if(!r)throw je({procedure:"Magic.rpcProvider.sendAsync",argument:1,expected:"function",received:r===null?"null":typeof r});if(Array.isArray(e))this.overlay.post(le.MagicOutgoingWindowMessage.MAGIC_HANDLE_REQUEST,e.map(s=>{let o=j(s);return this.prefixPayloadMethodForTestMode(o),o})).then(s=>{r(null,s.map(o=>he(B({},o.payload),{error:o.hasError?new L(o.payload.error):null})))});else{let s=j(e);this.prefixPayloadMethodForTestMode(s),this.overlay.post(le.MagicOutgoingWindowMessage.MAGIC_HANDLE_REQUEST,s).then(o=>{r(o.hasError?new L(o.payload.error):null,o.payload)})}}send(e,r){if(typeof e=="string"){let o=d(e,Array.isArray(r)?r:[]);return this.request(o)}if(Array.isArray(e)||!!r){this.sendAsync(e,r);return}let s=Be();return s.log(),new W(e).applyError({code:-32603,message:s.rawMessage}).payload}enable(){let e=d(le.MagicPayloadMethod.Login);return this.request(e)}request(e){return this.prefixPayloadMethodForTestMode(e),super.request(e)}prefixPayloadMethodForTestMode(e){let r="testMode/eth/";this.sdk.testMode&&(e.method=`${r}${e.method}`)}};var Dt=["request","overlay","sdk"];function cr(n){let t=Object.getPrototypeOf(n),e=[t];for(;t!==x.prototype;)t=Object.getPrototypeOf(t),e.push(t);return e}var Ce=class extends x{constructor(){super(void 0);this.__sdk_access_field_descriptors__=new Map;this.__is_initialized__=!1;this.utils={createPromiEvent:_,isPromiEvent:Xe,encodeJSON:oe,decodeJSON:qe,createJsonRpcRequestPayload:d,standardizeJsonRpcRequestPayload:j,storage:Y};let e=[this,...cr(this)];Dt.forEach(r=>{let s=e.map(c=>Object.getOwnPropertyDescriptor(c,r)),o=s.findIndex(c=>!!c),a=o>0,i=s[o];i&&(this.__sdk_access_field_descriptors__.set(r,{descriptor:i,isPrototypeField:a}),Object.defineProperty(this,r,{configurable:!0,get:()=>{throw Ge(r)}}))})}init(e){this.__is_initialized__||(Dt.forEach(r=>{if(this.__sdk_access_field_descriptors__.has(r)){let{descriptor:s,isPrototypeField:o}=this.__sdk_access_field_descriptors__.get(r);o?delete this[r]:Object.defineProperty(this,r,s)}}),this.sdk=e,this.__is_initialized__=!0)}createDeprecationWarning(e){let{method:r,removalVersion:s,useInstead:o}=e,a=o?` Use \`${o}\` instead.`:"",i=`\`${r}\` will be removed from this Extension in version \`${s}\`.${a}`;return new X(this,"DEPRECATION_NOTICE",i)}createWarning(e,r){return new X(this,e,r)}createError(e,r,s){return new K(this,e,r,s)}},st=class extends Ce{},k=class extends Ce{};k.Internal=st,k.Anonymous="anonymous extension";var Se=require("@magic-sdk/types");var Le=class extends x{purchase(t){let e=d(Se.MagicPayloadMethod.NFTPurchase,[t]);return this.request(e)}checkout(t){let e=d(Se.MagicPayloadMethod.NFTCheckout,[t]);return this.request(e)}transfer(t){let e=d(Se.MagicPayloadMethod.NFTTransfer,[t]);return this.request(e)}};function Ut(n){return n.compat&&n.compat[h.sdkName]!=null?typeof n.compat[h.sdkName]=="string"?Tt(It(h.version),n.compat[h.sdkName]):!!n.compat[h.sdkName]:!0}function lr(n,t,e){return!t&&!e?`${n}_eth_mainnet`:e?`${n}_${JSON.stringify(e)}`:t?typeof t=="string"?`${n}_eth_${t}`:`${n}_${t.rpcUrl}_${t.chainId}_${t.chainType}`:`${n}_unknown`}function ur(n){var s;let t=(s=n==null?void 0:n.extensions)!=null?s:[],e={},r=[];if(Array.isArray(t)?t.forEach(o=>{Ut(o)?(o.init(this),(o.name||o.name!==k.Anonymous)&&(this[o.name]=o),o instanceof k.Internal&&(V(o.config)||(e[o.name]=o.config))):r.push(o)}):Object.keys(t).forEach(o=>{if(Ut(t[o])){t[o].init(this);let a=t[o];this[o]=a,a instanceof k.Internal&&(V(a.config)||(e[t[o].name]=a.config))}else r.push(t[o])}),r.length)throw Ke(r);return e}var de=class{constructor(t,e){this.apiKey=t;var a;if(!t)throw We();h.platform==="react-native"&&(e==null?void 0:e.endpoint)&&He().log();let{defaultEndpoint:r,version:s}=h;this.testMode=!!(e!=null&&e.testMode),this.useStorageCache=!!(e!=null&&e.useStorageCache),this.endpoint=Me((a=e==null?void 0:e.endpoint)!=null?a:r).origin,this.auth=new be(this),this.user=new xe(this),this.wallet=new Ne(this),this.nft=new Le(this),this.rpcProvider=new Ae(this);let o=ur.call(this,e);this.parameters=oe(B({API_KEY:this.apiKey,DOMAIN_ORIGIN:window.location?window.location.origin:"",ETH_NETWORK:e==null?void 0:e.network,host:Me(this.endpoint).host,sdk:wt[h.sdkName],version:s,ext:V(o)?void 0:o,locale:(e==null?void 0:e.locale)||"en_US"},h.bundleId?{bundleId:h.bundleId}:{})),this.networkHash=lr(this.apiKey,e==null?void 0:e.network,V(o)?void 0:o),e!=null&&e.deferPreload||this.preload()}get overlay(){if(!de.__overlays__.has(this.parameters)){let t=new h.ViewController(this.endpoint,this.parameters,this.networkHash);t.init(),de.__overlays__.set(this.parameters,t)}return de.__overlays__.get(this.parameters)}preload(){return m(this,null,function*(){yield this.overlay.checkIsReadyForRequest})}},ue=de;ue.__overlays__=new Map;var pe=require("@magic-sdk/types");function dr(n,t){return t&&Array.isArray(n)?n.find(e=>e.id===t):n}function pr(n,t){var s;let e=(s=t.data.response)==null?void 0:s.id,r=dr(n,e);if(e&&r){let o=new W(r).applyResult(t.data.response.result).applyError(t.data.response.error);return{id:e,response:o}}return{}}function hr(n,t,e){return m(this,null,function*(){var i;let r=yield R("rt"),s;if(h.platform==="web")try{s=(i=yield R("jwt"))!=null?i:yield Qe()}catch(c){console.error("webcrypto error",c)}let o={msgType:n,payload:t};s&&(o.jwt=s),s&&r&&(o.rt=r);let a=yield qt(e);return a&&(o.deviceShare=a),o})}function mr(n){return m(this,null,function*(){!n.data.rt||(yield N("rt",n.data.rt))})}var Oe=class{constructor(t,e,r){this.endpoint=t;this.parameters=e;this.networkHash=r;this.messageHandlers=new Set;this.isConnectedToInternet=!0;this.checkIsReadyForRequest=this.waitForReady(),this.isReadyForRequest=!1,this.listen()}post(t,e){return m(this,null,function*(){return Ie((r,s)=>m(this,null,function*(){if(!this.isConnectedToInternet){let l=Fe();s(l)}this.isReadyForRequest||(yield this.waitForReady());let o=[],a=Array.isArray(e)?e.map(l=>l.id):[],i=yield hr(`${t}-${this.parameters}`,e,this.networkHash);yield this._post(i);let c=l=>p=>{var ot;let{id:$,response:I}=pr(e,p);if(mr(p),((ot=I==null?void 0:I.payload.error)==null?void 0:ot.message)==="User denied account access.")Q();else if(p.data.deviceShare){let{deviceShare:Wt}=p.data;kt(Wt,this.networkHash)}$&&I&&Array.isArray(e)&&a.includes($)?(o.push(I),o.length===e.length&&(l(),r(o))):$&&I&&!Array.isArray(e)&&$===e.id&&(l(),r(I))},u=this.on(pe.MagicIncomingWindowMessage.MAGIC_HANDLE_RESPONSE,c(()=>u()))}))})}on(t,e){let r=e.bind(window),s=o=>{o.data.msgType===`${t}-${this.parameters}`&&r(o)};return this.messageHandlers.add(s),()=>this.messageHandlers.delete(s)}waitForReady(){return new Promise(t=>{let e=this.on(pe.MagicIncomingWindowMessage.MAGIC_OVERLAY_READY,()=>{this.isReadyForRequest=!0,t(),e()})})}listen(){this.on(pe.MagicIncomingWindowMessage.MAGIC_HIDE_OVERLAY,()=>{this.hideOverlay()}),this.on(pe.MagicIncomingWindowMessage.MAGIC_SHOW_OVERLAY,()=>{this.showOverlay()})}};
//# sourceMappingURL=index.js.map
